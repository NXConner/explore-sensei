version: "3.9"
services:
  web:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        VITE_SUPABASE_URL: ${VITE_SUPABASE_URL}
        VITE_SUPABASE_ANON_KEY: ${VITE_SUPABASE_ANON_KEY}
        VITE_GOOGLE_MAPS_API_KEY: ${VITE_GOOGLE_MAPS_API_KEY}
        VITE_GOOGLE_API_KEY: ${VITE_GOOGLE_API_KEY}
        VITE_GOOGLE_KEY: ${VITE_GOOGLE_KEY}
        GOOGLE_MAPS_API_KEY: ${GOOGLE_MAPS_API_KEY}
    ports:
      - "5173:8080"
    environment:
      - NODE_ENV=production
    depends_on: []
  mlapi:
    build:
      context: ./ml
    environment:
      - ASPHALT_MODEL_PATH=/models/asphalt-yolov8s-seg.pt
      - PIXELS_PER_FOOT=3.0
    ports:
      - "8000:8000"
    volumes:
      - ./models:/models
